!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.variableMind=t():e.variableMind=t()}(self,(()=>(()=>{"use strict";var e={320:(e,t,n)=>{n.d(t,{Z:()=>s});var i=n(81),o=n.n(i),r=n(645),c=n.n(r)()(o());c.push([e.id,".mind-container .context-menu {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 99;\n}\n.mind-container .menu-list {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  font-size: 14px;\n  box-shadow: 0 12px 15px 0 rgba(0, 0, 0, 0.2);\n  font-weight: 300;\n  border-radius: 5px;\n  overflow: hidden;\n}\n.mind-container .menu-list li {\n  min-width: 150px;\n  overflow: hidden;\n  white-space: nowrap;\n  padding: 6px 10px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background-color: #fff;\n  border-bottom: 1px solid #ecf0f1;\n}\n.mind-container .menu-list li:hover {\n  cursor: pointer;\n  background-color: #ecf0f1;\n}\n.mind-container .menu-list .disabled {\n  display: none;\n}\n",""]);const s=c},744:(e,t,n)=>{n.d(t,{Z:()=>f});var i=n(81),o=n.n(i),r=n(645),c=n.n(r),s=n(667),a=n.n(s),d=new URL(n(286),n.b),l=new URL(n(190),n.b),p=c()(o()),h=a()(d),u=a()(l);p.push([e.id,".mind-container {\n  height: 100%;\n  width: 100%;\n  overflow: auto;\n  box-sizing: border-box;\n}\n.mind-canvas {\n  position: relative;\n  z-index: 0;\n  height: 20000px;\n  width: 20000px;\n}\n.root {\n  position: absolute;\n  display: block;\n  white-space: pre-wrap;\n  color: #fff;\n}\n.root .topic-text {\n  position: relative;\n  display: block;\n  padding: 10px 16px;\n  border-radius: 5px;\n  background: #00aaff;\n}\n.root .topic-text:hover {\n  cursor: pointer;\n}\n.root .topic-text .input-box {\n  position: absolute;\n  top: 0;\n  left: 0;\n  max-width: 500px;\n  width: max-content;\n  border: 2px solid #00aaff;\n  padding: 8px 10px;\n  background: #fff;\n  color: #333;\n  user-select: auto;\n  z-index: 2;\n}\n.children-box > group {\n  position: absolute;\n  margin-top: 0;\n}\n.children-box group {\n  display: flex;\n  align-items: center;\n}\n.children-box group .topic {\n  display: inline-block;\n  position: relative;\n  padding: 8px 16px;\n}\n.children-box group .topic .topic-text {\n  position: relative;\n  display: inline-block;\n  min-height: 34px;\n  max-width: 400px;\n  white-space: pre-wrap;\n  border: 1px solid #999;\n  border-radius: 5px;\n  padding: 8px 10px;\n  font-size: 12px;\n}\n.children-box group .topic .topic-text .input-box {\n  position: absolute;\n  left: 0;\n  top: 0;\n  max-width: 500px;\n  width: max-content;\n  border: 2px solid #00aaff;\n  padding: 8px 10px;\n  background: #fff;\n  user-select: auto;\n  z-index: 2;\n}\n.children-box group .topic .topic-text:hover {\n  cursor: pointer;\n}\n.children-box group .topic .selected {\n  outline: 2px solid #4dc4ff;\n}\n.children-box group .topic .expand {\n  position: absolute;\n  display: inline-block;\n  height: 10px;\n  width: 10px;\n  border-radius: 50%;\n  z-index: 1;\n}\n.children-box group .topic .expand:hover {\n  cursor: pointer;\n  opacity: 1;\n}\n.children-box group .topic .open {\n  opacity: 0;\n  background: url("+h+") no-repeat center / contain;\n}\n.children-box group .topic .close {\n  opacity: 1;\n  background: url("+u+") no-repeat center / contain;\n}\n.children-box group .inside-svg {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: -1;\n}\n.children-box .left-group {\n  direction: rtl;\n}\n.children-box .left-group .topic {\n  padding-right: 0;\n}\n.children-box .left-group .expand {\n  left: 0px;\n}\n.children-box .left-group group {\n  margin-right: 16px;\n}\n.children-box .right-group .topic {\n  padding-left: 0;\n}\n.children-box .right-group .expand {\n  right: 0px;\n}\n.children-box .right-group group {\n  margin-left: 16px;\n}\n.children-box .left-group > topic,\n.children-box .right-group > topic {\n  padding: 16px 16px;\n}\n.main-topic-svg {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  z-index: -1;\n}\ntext {\n  user-select: none;\n}\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: inherit;\n}\n.virtual-topic {\n  pointer-events: none;\n  height: 26px;\n  width: 80px;\n  background: lightskyblue;\n  border-radius: 6px;\n  z-index: 999;\n}\n",""]);const f=p},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,o,r){"string"==typeof e&&(e=[[null,e,void 0]]);var c={};if(i)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(c[a]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);i&&c[l[0]]||(void 0!==r&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=r),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var r={},c=[],s=0;s<e.length;s++){var a=e[s],d=i.base?a[0]+i.base:a[0],l=r[d]||0,p="".concat(d," ").concat(l);r[d]=l+1;var h=n(p),u={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==h)t[h].references++,t[h].updater(u);else{var f=o(u,i);i.byIndex=s,t.splice(s,0,{identifier:p,updater:f,references:1})}c.push(p)}return c}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var r=i(e=e||[],o=o||{});return function(e){e=e||[];for(var c=0;c<r.length;c++){var s=n(r[c]);t[s].references--}for(var a=i(e,o),d=0;d<r.length;d++){var l=n(r[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}r=a}}},569:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},190:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdD0iMTY1NjY1NDcxNzI0MiIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHZlcnNpb249IjEuMSIKICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+CiAgICA8cGF0aCBkPSJNNTEyIDc0LjY2NjY2N0MyNzAuOTMzMzMzIDc0LjY2NjY2NyA3NC42NjY2NjcgMjcwLjkzMzMzMyA3NC42NjY2NjcgNTEyUzI3MC45MzMzMzMgOTQ5LjMzMzMzMyA1MTIgOTQ5LjMzMzMzMyA5NDkuMzMzMzMzIDc1My4wNjY2NjcgOTQ5LjMzMzMzMyA1MTIgNzUzLjA2NjY2NyA3NC42NjY2NjcgNTEyIDc0LjY2NjY2N3oiIHN0cm9rZS13aWR0aD0iNTQiIHN0cm9rZT0nYmxhY2snIGZpbGw9J3doaXRlJyA+PC9wYXRoPgogICAgPHBhdGggZD0iTTY4Mi42NjY2NjcgNDgwaC0xMzguNjY2NjY3VjM0MS4zMzMzMzNjMC0xNy4wNjY2NjctMTQuOTMzMzMzLTMyLTMyLTMycy0zMiAxNC45MzMzMzMtMzIgMzJ2MTM4LjY2NjY2N0gzNDEuMzMzMzMzYy0xNy4wNjY2NjcgMC0zMiAxNC45MzMzMzMtMzIgMzJzMTQuOTMzMzMzIDMyIDMyIDMyaDEzOC42NjY2NjdWNjgyLjY2NjY2N2MwIDE3LjA2NjY2NyAxNC45MzMzMzMgMzIgMzIgMzJzMzItMTQuOTMzMzMzIDMyLTMydi0xMzguNjY2NjY3SDY4Mi42NjY2NjdjMTcuMDY2NjY3IDAgMzItMTQuOTMzMzMzIDMyLTMycy0xNC45MzMzMzMtMzItMzItMzJ6Ij48L3BhdGg+Cjwvc3ZnPg=="},286:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdD0iMTY1NjY1NTU2NDk4NSIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHZlcnNpb249IjEuMSIKICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+CiAgICA8cGF0aCBkPSJNNTEyIDc0LjY2NjY2N0MyNzAuOTMzMzMzIDc0LjY2NjY2NyA3NC42NjY2NjcgMjcwLjkzMzMzMyA3NC42NjY2NjcgNTEyUzI3MC45MzMzMzMgOTQ5LjMzMzMzMyA1MTIgOTQ5LjMzMzMzMyA5NDkuMzMzMzMzIDc1My4wNjY2NjcgOTQ5LjMzMzMzMyA1MTIgNzUzLjA2NjY2NyA3NC42NjY2NjcgNTEyIDc0LjY2NjY2N3oiIHN0cm9rZS13aWR0aD0iNTQiIHN0cm9rZT0nYmxhY2snIGZpbGw9J3doaXRlJyA+PC9wYXRoPgogICAgPHBhdGggZD0iTTY4Mi42NjY2NjcgNTQ0SDM0MS4zMzMzMzNjLTE3LjA2NjY2NyAwLTMyLTE0LjkzMzMzMy0zMi0zMnMxNC45MzMzMzMtMzIgMzItMzJoMzQxLjMzMzMzNGMxNy4wNjY2NjcgMCAzMiAxNC45MzMzMzMgMzIgMzJzLTE0LjkzMzMzMyAzMi0zMiAzMnoiPjwvcGF0aD4KPC9zdmc+"}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,n),r.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.b=document.baseURI||self.location.href,n.nc=void 0;var i={};return(()=>{n.d(i,{default:()=>S});var e=n(379),t=n.n(e),o=n(795),r=n.n(o),c=n(569),s=n.n(c),a=n(565),d=n.n(a),l=n(216),p=n.n(l),h=n(589),u=n.n(h),f=n(744),g={};g.styleTagTransform=u(),g.setAttributes=d(),g.insert=s().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=p(),t()(f.Z,g),f.Z&&f.Z.locals&&f.Z.locals;const M="http://www.w3.org/2000/svg",m=function(e){const t=document.createElementNS(M,"svg");return t.setAttribute("class",e),t},x=function(e,t="#666"){const n=document.createElementNS(M,"path");return n.setAttribute("d",e),n.setAttribute("stroke",t),n.setAttribute("fill","none"),n.setAttribute("stroke-width","2"),n},b=function(){return((new Date).getTime().toString(16)+Math.random().toString(16).substr(2)).substr(2,16)},N=function(e,t){e.parent=t;const n=e.children;if(n&&n.length>0)for(let t=0;t<n.length;t++)N(n[t],e)},z=function(e,t,n=!0){const i=e.parent,o=t.parent.children;o.splice(o.indexOf(t),1),t.parent=i;const r=i.children;n?r.splice(r.indexOf(e),0,t):r.splice(r.indexOf(e)+1,0,t)},y=function(e){const t=e.parent.children,n=t.indexOf(e);t.splice(n,1)},v=function(e){const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t))};function j(e,t,n,i){let o="",r="",c="",s="#666";if("left"===n){let a=e.offsetLeft,d=e.offsetTop+e.offsetHeight/2;t.length&&(o=`M ${a+15} ${d} H ${a+5}`,i.appendChild(x(o,s)));for(let e=0;e<t.length;e++){let l=t[e];s=l.classList.contains("virtual-group")?"lightskyblue":"#666",r=l.offsetLeft+l.offsetWidth,c=l.offsetTop+l.offsetHeight/2,o=`M ${a+5} ${d} Q ${a+5} ${c} ${r} ${c}`,i.appendChild(x(o,s)),t[e].children[1]&&j(t[e].children[0],t[e].children[1].children,n,i)}}else{let a=e.offsetLeft+e.offsetWidth,d=e.offsetTop+e.offsetHeight/2;t.length&&(o=`M ${a-15} ${d} H ${a-5}`,i.appendChild(x(o,s)));for(let e=0;e<t.length;e++){let l=t[e];s=l.classList.contains("virtual-group")?"lightskyblue":"#666",r=l.offsetLeft,c=l.offsetTop+l.offsetHeight/2,o=`M ${a-5} ${d} Q ${a-5} ${c} ${r} ${c}`,i.appendChild(x(o,s)),t[e].children[1]&&j(t[e].children[0],t[e].children[1].children,n,i)}}}const T="插入子节点",C="插入同级节点",I="删除节点";var L=n(320),E={};function w(e,t){const n=function(e,t,n){const i=document.createElement("li");return i.id=e,i.innerHTML=`<span>${t}</span><span>${n}</span>`,i},i=n("add_child",T,"tab"),o=n("add_sibling",C,"enter"),r=n("remove_node",I,"delete"),c=document.createElement("ul");c.className="menu-list",c.appendChild(i),c.appendChild(o),c.appendChild(r),e.container.appendChild(c);const s=document.createElement("div");s.appendChild(c),s.classList.add("context-menu"),e.container.appendChild(s),s.hidden=!0;let a=!1;e.container.oncontextmenu=function(t){if(t.preventDefault(),!e.editable)return;const n=t.target;if("TEXT"===n.tagName){"ROOT"===t.target.parentElement.tagName?(a=!0,o.classList.add("disabled"),r.classList.add("disabled")):(a=!1,o.classList.remove("disabled"),r.classList.remove("disabled")),e.selectNode(n),s.hidden=!1;const i=c.offsetHeight,d=c.offsetWidth,l=e.container.getBoundingClientRect().left,p=e.container.getBoundingClientRect().top,h=e.container.offsetHeight,u=e.container.offsetWidth,f=t.clientY-p,g=t.clientX-l;f+i>p+h?(c.style.top="",c.style.bottom="0px"):(c.style.top=f+"px",c.style.bottom=""),g+d>l+u?(c.style.left="",c.style.right="0px"):(c.style.left=g+"px",c.style.right="")}},e.container.onclick=function(e){e.target===s&&(s.hidden=!0)},i.onclick=function(t){e.addChild(),s.hidden=!0},o.onclick=function(t){a||(e.addSibling(),s.hidden=!0)},r.onclick=function(t){a||(e.removeNode(),s.hidden=!0)}}E.styleTagTransform=u(),E.setAttributes=d(),E.insert=s().bind(null,"head"),E.domAPI=r(),E.insertStyleElement=p(),t()(L.Z,E),L.Z&&L.Z.locals&&L.Z.locals;const A=function(e,t){if(!e)return;const n=e.nodeObj,i=t||this.generateNewObj();N(i,n),i.direction="right",n.children?n.children.push(i):n.children=[i];const o=this.createGroup(i),r=e.parentElement.parentElement;if("ROOT"===r.tagName)r.nextSibling&&r.nextSibling.appendChild(o);else{let e=r.children[1];e||(e=document.createElement("children"),r.appendChild(e)),e.appendChild(o)}return this.linkTopic(),o};function k(e){const t={13:()=>{e.addSibling()},9:()=>{e.addChild()},32:()=>{e.currentNode&&e.createInputBox(e.currentNode)}};e.canvas.onkeydown=n=>{n.preventDefault(),e.editable&&n.target===n.currentTarget&&(8===n.keyCode||46===n.keyCode?e.removeNode():t[n.keyCode]&&t[n.keyCode](n))}}function D(e,t,n){if("child"===n){let n=t.nextSibling;if(!n){const e=document.createElement("children");t.parentElement.appendChild(e),n=e}n.appendChild(e),this.linkTopic()}if("before"===n){const n=t.parentElement;n.parentElement.insertBefore(e,n),this.linkTopic()}if("after"===n){const n=t.parentElement;n.parentElement.insertBefore(e,n.nextSibling),this.linkTopic()}}function Y(e){if(!e)return new Error("缺少配置");if(!e.el)return new Error('缺少"el"配置');const t=document.querySelector(e.el);if(!t)return new Error("挂载节点不存在");this.container=document.createElement("div"),this.container.className="mind-container",this.canvas=document.createElement("div"),this.canvas.className="mind-canvas",this.canvas.setAttribute("tabindex","0"),this.root=document.createElement("root"),this.root.className="root",this.childrenBox=document.createElement("children"),this.childrenBox.className="children-box",this.mainTopicSvgLink=m("main-topic-svg"),this.canvas.appendChild(this.root),this.canvas.appendChild(this.childrenBox),this.canvas.appendChild(this.mainTopicSvgLink),this.container.appendChild(this.canvas),t.appendChild(this.container),this.currentNode="",this.theme=e.theme,this.editable=e.editable,this.newTopicName=e.newTopicName,this.draggable=e.draggable,this.direction=e.direction,this.contextMenu=w,this.keypress=k,this.contextMenuOption=e.contextMenuOption,function(e){e.canvas.addEventListener("click",(t=>{e.unSelectNode(),"EXPAND"===t.target.nodeName&&e.expandNode(t.target.previousSibling),"TEXT"===t.target.nodeName&&e.selectNode(t.target)})),e.canvas.addEventListener("dblclick",(t=>{t.preventDefault(),"TEXT"===t.target.nodeName&&e.createInputBox(t.target)}))}(this)}Y.prototype={toCenter:function(){this.container.scrollTo(this.canvas.offsetWidth/2-this.container.offsetWidth/2,this.canvas.offsetHeight/2-this.container.offsetHeight/2)},layout:function(e){if(this.root.innerHTML="",this.childrenBox.innerHTML="",e.root){const t=function(e){const t=document.createElement("text");return t.nodeObj=e,t.className="topic-text",t.innerHTML=e.topic,t}(e);this.root.appendChild(t)}let t=0,n=0,i=e.children;for(let e=0;e<i.length;e++)"left"===i[e].direction?t+=1:"right"===i[e].direction?n+=1:t<=n?(i[e].direction="left",t+=1):(i[e].direction="right",n+=1);e.children&&e.children.length>0&&this.createChildTopic(e.children,this.childrenBox)},linkTopic:function(){this.mainTopicSvgLink.innerHTML="";const e=this.canvas.offsetHeight,t=this.canvas.offsetWidth,n=e/2-this.root.offsetHeight/2,i=t/2-this.root.offsetWidth/2;this.root.style.cssText=`top: ${n}px; left: ${i}px`;const o=this.childrenBox.children;let r=0,c=0,s=0,a=0;for(let e=0;e<o.length;e++)"left"===o[e].getAttribute("position")?r+=o[e].offsetHeight:c+=o[e].offsetHeight;s=e/2-r/2,a=e/2-c/2;let d=s,l=a;for(let n=0;n<o.length;n++){const i=o[n];let r="",c="",s="",a="",p=e/2,h="",u="#666";u=i.classList.contains("virtual-group")?"lightskyblue":"#666","left"===i.getAttribute("position")?(a=t/2-this.root.offsetWidth/6,h=t/2-this.root.offsetWidth/2-i.offsetWidth-20,i.style.cssText=`top: ${d}px; left: ${h}px`,c=h+i.offsetWidth,s=d+i.offsetHeight/2,d+=i.offsetHeight,r=`M ${a} ${p} C ${a} ${s} ${a} ${s} ${c} ${s}`,this.mainTopicSvgLink.appendChild(x(r,u))):(a=t/2+this.root.offsetWidth/6,h=t/2+this.root.offsetWidth/2+20,i.style.cssText=`top: ${l}px; left: ${h}px`,c=h,s=l+i.offsetHeight/2,l+=i.offsetHeight,r=`M ${a} ${p} C ${a} ${s} ${a} ${s} ${c} ${s}`,this.mainTopicSvgLink.appendChild(x(r,u)))}for(let e=0;e<o.length;e++){let t=o[e];if(t.childElementCount){const e=m("inside-svg");"svg"===t.lastChild.tagName&&t.lastChild.remove(),t.appendChild(e);let n=t.children[0],i=t.children[1].children,o=t.getAttribute("position");i&&i.length>0&&j(n,i,o,e)}}},expandNode:function(e,t){e.nodeObj.expanded=!e.nodeObj.expanded,this.layout(this.nodeData),this.linkTopic(!0)},selectNode:function(e){e&&(this.currentNode&&this.currentNode.classList.remove("selected"),this.currentNode=e,this.currentNode.classList.add("selected"))},unSelectNode:function(){const e=this.currentNode;e&&(e.classList.remove("selected"),this.currentNode=null)},createInputBox:function(e){if(!e)return;const t=e.textContent,n=document.createElement("div");e.appendChild(n),n.setAttribute("contenteditable",!0),n.setAttribute("spellcheck",!1),n.classList.add("input-box"),n.textContent=t,n.style.cssText=`min-width: ${e.offsetWidth}px`,n.focus(),v(n),n.addEventListener("keydown",(e=>{e.stopPropagation();const t=e.key;if("Enter"===t||"Tab"===t){if(e.shiftKey)return;e.preventDefault(),n.blur()}})),n.addEventListener("blur",(t=>{const i=t.target.textContent;e.nodeObj.topic=i,e.textContent=i,n.remove(),this.layout(this.nodeData),this.linkTopic()}))},addChild:function(e,t){const n=e||this.currentNode;if(!n)return;const i=A.call(this,n,t).children[0].children[0];this.createInputBox(i)},generateNewObj:function(){const e=b();return{topic:this.newTopicName||"新节点",id:e}},createGroup:function(e){const t=document.createElement("group"),n=this.createTopic(e);return t.appendChild(n),t},addSibling:function(e,t){const n=e||this.currentNode;if(!n)return;const i=n.nodeObj,o=t||this.generateNewObj();!function(e,t){const n=e.parent,i=n.children;t.parent=n;const o=i.indexOf(e);i.splice(o+1,0,t)}(i,o);const r=this.createGroup(o),c=n.parentElement,s=c.parentElement.parentElement;s.insertBefore(r,c.parentElement.nextSibling),s.classList.contains("children-box")&&(o.direction="right"),this.linkTopic();const a=r.children[0].children[0];this.createInputBox(a)},addParentLink:N,removeNode:function(e,t){const n=e||this.currentNode;if(!n)return;const i=n.nodeObj;y(i);const o=n.parentElement.parentElement,r=o.previousElementSibling,c=o.nextElementSibling,s=o.parentElement.parentElement;let a="";a=i.parent.children.length?r?r.children[0].children[0]:c.children[0].children[0]:s.children[0].children[0],o.parentElement.removeChild(o),this.linkTopic(),this.selectNode(a)},createTopic:function(e){e.id=e.id?e.id:b();const t=document.createElement("topic"),n=document.createElement("text");return n.id=e.id,n.draggable=this.draggable,n.nodeObj=e,n.className="topic-text",t.className="topic",n.innerHTML=e.topic,t.appendChild(n),t},createChildTopic:function(e,t,n){for(let n=0;n<e.length;n++){const i=e[n],o=document.createElement("group");"left"===i.direction?(o.setAttribute("position","left"),o.className="left-group"):"right"===i.direction&&(o.setAttribute("position","right"),o.className="right-group");const r=this.createTopic(i);t.appendChild(o),o.appendChild(r);const c=r.children[0],s=r.getBoundingClientRect(),a=c.getBoundingClientRect();if(r.point={x:a.width,y:s.height/2},c.line=a.height/2,i.children&&i.children.length>0){!1!==i.expanded&&(i.expanded=!0);const e=document.createElement("expand");e.className="expand",r.appendChild(e);let t=r.offsetHeight;if(e.style.top=(t-e.offsetHeight)/2+"px",i.expanded){e.className=`${e.className} open`;const t=document.createElement("children");o.appendChild(t),this.createChildTopic(i.children,t,i.direction)}else e.className=`${e.className} close`}}},selectNodeText:v,init(e){if(!e||!e.nodeData)return new Error("节点数据为空");this.contextMenu&&this.contextMenu(this,this.contextMenuOption),this.keypress&&this.keypress(this),this.draggable&&function(e){let t=null,n=null,i=null,o=null,r=null,c=function(){const e=document.createElement("group"),t=document.createElement("topic");return e.classList.add("virtual-group"),t.classList.add("virtual-topic"),e.appendChild(t),e}();e.canvas.addEventListener("dragstart",(e=>{const t=e.target;if(!t)return;const n=t.parentElement.parentElement;n.style.opacity=.5,e.dataTransfer.effectAllowed="move",i=n})),e.canvas.addEventListener("dragover",(function(s){s.preventDefault();const a=s.target;c.style.display="";const d=e.root.contains(a);if("svg"!==a.nodeName&&!i.contains(a)&&!d){if(c.style.display="","TOPIC"===a.nodeName){const e=a.point;n=s.offsetX>e.x?"child":s.offsetY<e.y?"before":"after",o=a}"TEXT"===a.nodeName&&(n=s.offsetY<a.line?"before":"after",o=a.parentElement),n!==t?(t=n,D.call(e,c,o,n),t=n):r!==o&&(D.call(e,c,o,n),r=o)}})),e.canvas.addEventListener("drop",(t=>{let o=c;const r=o.parentElement;let s=null;if(!n)return void(i.style.opacity=1);const a=i.children[0].children[0].nodeObj;y(a),"child"===n&&(s=o.parentElement.previousSibling.children[0].nodeObj,a.parent=s,s.children?s.children.push(a):s.children=[a]);let d="";if("before"===n){const e=o.nextSibling,t=e.getAttribute("position");t&&(d=t),s=e.children[0].children[0].nodeObj,z(s,a)}if("after"===n){const e=o.previousSibling,t=e.getAttribute("position");t&&(d=t),s=e.children[0].children[0].nodeObj,z(s,a,!1)}if("svg"===i.lastChild.nodeName&&i.lastChild.remove(),d){const e="left"===d?"left-group":"right-group";i.setAttribute("position",d),a.direction=d,i.classList.add(e)}r.insertBefore(i,o),i.style.opacity=1,r.removeChild(o),e.linkTopic(),console.log("---nodeData",e.nodeData)}))}(this),this.nodeData=e.nodeData,N(this.nodeData),this.toCenter(),this.layout(this.nodeData),this.linkTopic()}};const S=Y})(),i.default})()));